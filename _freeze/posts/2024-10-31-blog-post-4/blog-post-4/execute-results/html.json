{
  "hash": "ffb336e6501077366b5596fd7d904aeb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"blog post 4\"\nauthor: \"Sean Fung\"\ndate: \"2024-10-31\"\ndate-modified: \"2024-10-31\"\ndraft: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nhere() starts at /Users/seanfung/Documents/BU Fall 2024/MA 415/MA 415 G4 Final Project\n```\n\n\n:::\n\n```{.r .cell-code}\ndata <- readRDS(here(\"filtered_data_2.rds\"))\n\nfiltered_data <- subset(data, Descent_Description != \"Unknown\" & Descent_Description != \"Other\")\n\n# Create a contingency table for the filtered data\ncrime_table_filtered <- table(filtered_data$Descent_Description, filtered_data$Crm.Cd.Desc)\n\nchi_test_filtered <- chisq.test(crime_table_filtered)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(crime_table_filtered): Chi-squared approximation may be\nincorrect\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(chi_test_filtered)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  crime_table_filtered\nX-squared = 2363.8, df = 1222, p-value < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extract standardized residuals\nstandardized_residuals_filtered <- chi_test_filtered$stdres\n\ntop_crimes <- names(sort(colSums(crime_table_filtered), decreasing = TRUE))[1:20]\n\n# Filter the contingency table to only include top crime types\ncrime_table_top <- crime_table_filtered[, top_crimes]\n\nchi_test_top <- chisq.test(crime_table_top)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(crime_table_top): Chi-squared approximation may be\nincorrect\n```\n\n\n:::\n\n```{.r .cell-code}\nstandardized_residuals_top <- chi_test_top$stdres\n\n\nresiduals_top_df <- as.data.frame(as.table(standardized_residuals_top))\ncolnames(residuals_top_df) <- c(\"Descent\", \"Crime_Type\", \"Residual\")\n\n\n\nggplot(residuals_top_df, aes(x = Crime_Type, y = Descent, fill = Residual)) +\n  geom_tile() +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0) +\n  labs(title = \"Standardized Residuals of Descent and Top Crime Types\",\n       x = \"Crime Type\", y = \"Descent Category\", fill = \"Residual\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](blog-post-4_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\nI wanted to ask the question of whether every crime was correlated to descent. Therefore, I conducted a chi-squared test and wanted to see how each race's residual was in comparison to the top 10 crimes (all crimes would be too much). \n- We can see that \"White\" had a high residual in the burglary category and higher residuals in some other categories as well. We also see lower than average residuals in the aggrevated assault and simple assault categories. \n- As for Hispanic/Mexican, even though they represent such a high amount of crimes (as seen in last blog post), they are moderately around what is expected with the exception of the \"Burglary\" and \"Theft (under $950) categories.\n- Other Asian slightly higher in \"Burglary\"\n- \"Black\" lower in \"theft from motor vehicle\". \n- \"Filipino\" higher in \"theft from motor vehicle\". \n- \"Chinese\" higher in \"theft - grand except guns or livestock\". \n- Everything else is mostly the same hovering around the expected with small fluctuations.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code}\ncrime_hour_descent <- data %>%\n  group_by(Hour, Crm.Cd.Desc, Descent_Description) %>%\n  summarise(Count = n(), .groups = \"drop\") %>%\n  filter(Count > 0)\n\nggplot(crime_hour_descent, aes(x = Hour, y = Descent_Description, fill = Count)) +\n  geom_tile(color = \"white\") +\n  scale_fill_gradient(low = \"lightblue\", high = \"darkred\", name = \"Crime Count\") + \n  labs(title = \"Heatmap of Crime Counts by Hour and Descent\",\n       x = \"Hour of Day\",\n       y = \"Descent Category\")\n```\n\n::: {.cell-output-display}\n![](blog-post-4_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\nI make this plot to visualize how crime frequency varies for each descent category by time of the day. I use heatmap since it provides a direct comparison across different times and descents. This plot clearly shows that certain racial categories, such as White, Hispanic/Latin/Mexican, and Black, experience higher crime rates compared to racial groups like Cambodian and Laotian, potentially due to smaller sample sizes or data collection biases.\n\nThe general trend across most categories indicates a peak in crime rates from late evening to early morning (00:00 to 05:00), which is the same as what we expected. However, an additional peak occurs during daytime (10:00 to 15:00), which is unusual and needs further investigation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(here)\ncrime_data <- readRDS(here(\"filtered_data_2.rds\")) %>%\n  mutate(across(c(AREA.NAME, Crm.Cd.Desc, Descent_Description), ~ trimws(tolower(.))))\ncrime_area_descent_summary <- crime_data %>%\n  count(AREA.NAME, Crm.Cd.Desc, Descent_Description, name = \"Crime_Count\")\n\n# Get top 10 areas and crimes\ntop_10_areas <- crime_area_descent_summary %>%\n  count(AREA.NAME, wt = Crime_Count, sort = TRUE) %>%\n  slice_head(n = 10) %>%\n  pull(AREA.NAME)\ntop_10_crimes <- crime_area_descent_summary %>%\n  count(Crm.Cd.Desc, wt = Crime_Count, sort = TRUE) %>%\n  slice_head(n = 10) %>%\n  pull(Crm.Cd.Desc)\n\nfiltered_data <- crime_area_descent_summary %>%\n  filter(AREA.NAME %in% top_10_areas, Crm.Cd.Desc %in% top_10_crimes)\n\n# Chi-square test for Crime Type vs. Area\ncrime_type_area<- xtabs(Crime_Count ~ Crm.Cd.Desc + AREA.NAME, data = filtered_data)\nchi_test_crime_area <- chisq.test(crime_type_area)\nprint(\"Chi-Square Test Result: Crime Type vs. Area\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test Result: Crime Type vs. Area\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(chi_test_crime_area)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  crime_type_area\nX-squared = 451.13, df = 81, p-value < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# Chi-square test for Descent Group vs. Area\ndescent_area <- xtabs(Crime_Count ~ Descent_Description + AREA.NAME, data = filtered_data)\nchi_test_descent_area <- chisq.test(descent_area)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in chisq.test(descent_area): Chi-squared approximation may be incorrect\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(\"Chi-Square Test Result: Descent Group vs. Area\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Chi-Square Test Result: Descent Group vs. Area\"\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(chi_test_descent_area)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  descent_area\nX-squared = 1051.2, df = 135, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\nboth of the chi-square tests have low p-value, indicating that the variables are statistically associated. With the chi-sqaure test on crime type - descent group, I wanted to understand the distribution across these three variables at once.  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\n\n# Plot\nggplot(filtered_data, aes(x = reorder(Crm.Cd.Desc, -Crime_Count), y = Crime_Count, fill = AREA.NAME)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  facet_wrap(~ Descent_Description, ncol = 3) +\n  labs(\n    title = \"Most Prevalent Area for Top Crimes by Descent Group (Top 10 Areas and Crimes)\",\n    x = \"Crime Type\",\n    y = \"Crime Count\",\n    fill = \"Area\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1, size = 6),\n    strip.text = element_text(size = 10),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-4_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThis graph shows the distributions across crime types, geographic areas, and descent groups within the top 10 most frequent crime types and top 10 areas(it's actually 11 areas in the graph: 'hollywood' and ' n hollywood' are counted as separate entries) with the highest crime counts. Here are some key patterns from the graph: noted that some descent groups, like Black, Hispanic/Latin/Mexican, and White, experienced a wider range of crime types across multiple areas, whereas others had more limited exposure. Certain areas, such as 77th Street, Central, and Southwest, consistently showed high counts across multiple crime types, showing that they are hopspts for various types of crime. Last but not least, vehicle theft, simple assault, and petty theft were widespread acroos areas and descent groups. \n\n",
    "supporting": [
      "blog-post-4_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}