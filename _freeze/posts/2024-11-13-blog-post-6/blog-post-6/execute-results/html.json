{
  "hash": "db0784f7b6ab3a0dd19aa78b43f5c213",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"blog post 6\"\nauthor: \"Sean Fung, Zihao Guo, Yawen Zhang\"\ndate: \"2024-11-13\"\ndate-modified: \"2024-11-13\"\ndraft: FALSE\n---\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n\nhere() starts at /Users/seanfung/Documents/BU Fall 2024/MA 415/MA 415 G4 Final Project\n\nLoading required package: viridisLite\n\nTo install your API key for use in future sessions, run this function with `install = TRUE`.\n\nGetting data from the 2016-2020 5-year ACS\n\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n\n\n:::\n:::\n\n\n# Crime V Median Income\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](blog-post-6_files/figure-html/Crime V Median Income Plot-1.png){width=672}\n:::\n:::\n\n\n\n# Economic Heatmap (Without Crime Data)\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](blog-post-6_files/figure-html/Income heat map (see bp5)-1.png){width=672}\n:::\n:::\n\n\n\n# Plot: Combined Map with Income and Crime Data -- Black Dots (Crime Locations) on Economic Data Heatmap\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](blog-post-6_files/figure-html/Heatmap with crime data-1.png){width=672}\n:::\n:::\n\n\n\n# Linear Model\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = total_crimes ~ avg_income, data = crime_summary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n -5.480  -2.887  -1.364   1.186 125.843 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  6.528e+00  2.414e-01  27.048  < 2e-16 ***\navg_income  -1.952e-05  2.784e-06  -7.013 3.05e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.608 on 2319 degrees of freedom\nMultiple R-squared:  0.02077,\tAdjusted R-squared:  0.02034 \nF-statistic: 49.18 on 1 and 2319 DF,  p-value: 3.054e-12\n```\n\n\n:::\n:::\n\n\nBased on the above models, we need to be looking at the certain areas with crime data as the LAPD seems to be concentrated in the multiple districts in the Southwest. Try to adjust for bias. \n\n## Crime in each neighborhood\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define broader crime categories based on `Crm.Cd.Desc`\ncrime_with_neighborhoods <- crime_with_neighborhoods %>%\n  mutate(Crime_Category = case_when(\n    str_detect(Crm.Cd.Desc, \"BURGLARY|THEFT|VANDALISM|EMBEZZLEMENT|FORGERY|SHOPLIFTING\") ~ \"Property Crime\",\n    str_detect(Crm.Cd.Desc, \"ASSAULT|ROBBERY|HOMICIDE|KIDNAPPING|SEXUAL ASSAULT\") ~ \"Violent Crime\",\n    str_detect(Crm.Cd.Desc, \"DRUG\") ~ \"Drug Offense\",\n    str_detect(Crm.Cd.Desc, \"TRAFFIC|DRIVING|DUI|FAILURE TO YIELD\") ~ \"Traffic Violation\",\n    TRUE ~ \"Other\"\n  ))\ncrime_summary <- crime_with_neighborhoods %>%\n  group_by(AREA.NAME, Crime_Category) %>%\n  summarize(total_crimes = n(), .groups = \"drop\")\nggplot(crime_summary, aes(x = reorder(AREA.NAME, total_crimes), y = total_crimes, fill = Crime_Category)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  labs(\n    title = \"Crime Categories by Neighborhood\",\n    x = \"Neighborhood\",\n    y = \"Total Crimes\",\n    fill = \"Crime Category\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](blog-post-6_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(crime_summary, aes(x = reorder(AREA.NAME, total_crimes), y = total_crimes, fill = Crime_Category)) +\n  geom_bar(stat = \"identity\", position = \"fill\") +\n  labs(\n    title = \"Proportion of Crime Categories by Neighborhood\",\n    x = \"Neighborhood\",\n    y = \"Proportion\",\n    fill = \"Crime Category\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](blog-post-6_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThese graphs tell a compelling story about crime patterns in neighborhoods. Property crimes are a widespread issue, while violent crimes are relatively localized. Hollywood and similar areas show distinctive crime patterns, suggesting localized factors influencing crime dynamics.The 77th Street neighborhood stands out in both graphs due to the almost equal distribution of Property Crime and Other Crime categories. This is unusual compared to most neighborhoods where Property Crime significantly dominates.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nset.seed(123) \n\nkmeans_data <- crime_with_income %>%\n  group_by(AREA.NAME) %>%\n  summarize(\n    avg_income = mean(estimate, na.rm = TRUE),  \n    total_crimes = n()  \n  ) %>%\n  na.omit() \nkmeans_data_numeric <- kmeans_data %>%\n  st_drop_geometry() %>%  \n  select(avg_income, total_crimes)  \nkmeans_result <- kmeans(kmeans_data_numeric, centers = 3)\nkmeans_data <- kmeans_data %>%\n  mutate(cluster = factor(kmeans_result$cluster))\n\n\nggplot(kmeans_data, aes(x = avg_income, y = total_crimes, color = cluster)) +\n  geom_point(size = 3, alpha = 0.7) +\n  labs(\n    title = \"clustering neighborhoods by income and crime\",\n    x = \"Median Income\",\n    y = \"Total Crimes\",\n    color = \"Cluster\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](blog-post-6_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\ncluster 1: moderate crime counts and moderate income levels\ncluster 2: higher income levels and lower crime counts\ncluster 3: high crime counts and lower income levels \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_centers <- as.data.frame(kmeans_result$centers)\n\nggplot(kmeans_data, aes(x = avg_income, y = total_crimes, color = cluster)) +\n  geom_point(size = 3, alpha = 0.7) +\n  geom_point(data = cluster_centers, aes(x = avg_income, y = total_crimes), size = 5, shape = 17, color = \"black\") + \n  labs(\n    title = \"clustering neighborhoods by income and crime with centroids\",\n    x = \"Median Income\",\n    y = \"Total Crimes\",\n    color = \"Cluster\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](blog-post-6_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nthe black triangles represent the average values of income and crime for each cluster. this shows that crime counts decrease as median income increases. ",
    "supporting": [
      "blog-post-6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}