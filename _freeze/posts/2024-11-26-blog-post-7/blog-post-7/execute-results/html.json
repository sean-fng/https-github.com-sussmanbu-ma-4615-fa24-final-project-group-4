{
  "hash": "27dbbfaa42f7b5cd3ce2ecc364a3d21b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"blog post 7\"\nauthor: \"Sean Fung\"\ndate: \"2024-11-26\"\ndate-modified: \"2024-11-26\"\ndraft: FALSE\n---\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n\nhere() starts at /Users/seanfung/Documents/BU Fall 2024/MA 415/MA 415 G4 Final Project\n\nLoading required package: viridisLite\n\n\nAttaching package: 'MASS'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\n\nTo install your API key for use in future sessions, run this function with `install = TRUE`.\n\nGetting data from the 2016-2020 5-year ACS\n\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Update visualizations\nggplot(crime_summary_lapd, aes(x = avg_income, y = total_crimes)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"Crime vs Median Income (LAPD Jurisdiction)\", x = \"Median Income\", y = \"Total Crimes\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Crime Vs Median Income-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = economic_data_lapd, aes(fill = estimate), color = NA) +  # Median income layer\n  scale_fill_viridis_c(option = \"magma\", na.value = \"grey50\") +\n  scale_color_viridis_c(option = \"inferno\", na.value = \"grey50\") +\n  labs(\n    title = \"Median Income within LAPD Jurisdiction\",\n    fill = \"Median Income\",\n    color = \"Average Income\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 18, hjust = 0.5),\n    legend.title = element_text(size = 14),\n    legend.text = element_text(size = 12),\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 10)\n  ) +\n  coord_sf(\n    xlim = c(-119, -117),  # Focus on the Los Angeles area\n    ylim = c(33, 35)       # Focus on the Los Angeles area\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Heatmap within LAPD Jurisdiction-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_within_lapd <- st_transform(crime_within_lapd, st_crs(economic_data_lapd))\n\nggplot() +\n  # Median income heatmap\n  geom_sf(data = economic_data_lapd, aes(fill = estimate), color = NA) +  \n  scale_fill_viridis_c(option = \"magma\", na.value = \"grey50\") +\n  scale_color_viridis_c(option = \"inferno\", na.value = \"grey50\") +\n  # Overlay crime points\n  geom_sf(data = crime_within_lapd, aes(), color = \"black\", shape = 4, size = 0.5, alpha = 0.7) +\n  labs(\n    title = \"Median Income and Crime Data within LAPD Jurisdiction\",\n    fill = \"Median Income\",\n    color = \"Average Income\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 18, hjust = 0.5),\n    legend.title = element_text(size = 14),\n    legend.text = element_text(size = 12),\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 10)\n  ) +\n  coord_sf(\n    xlim = c(-119, -117),  # Focus on the Los Angeles area\n    ylim = c(33, 35)       # Focus on the Los Angeles area\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Heatmap with Crime Data-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Good place to use shinylive here. Can filter by year. \n\n# crime_filtered <- crime_within_lapd %>%\n#   filter(year == 2021)\n# ggplot() +\n#   geom_sf(data = economic_data_lapd, aes(fill = estimate), color = NA) +  \n#   scale_fill_viridis_c(option = \"magma\", na.value = \"grey50\") +\n#   geom_sf(data = crime_filtered, aes(), color = \"black\", shape = 4, size = 0.5, alpha = 0.7) +\n#   labs(\n#     title = \"Median Income and 2020 Crime Data within LAPD Jurisdiction\",\n#     fill = \"Median Income\"\n#   ) +\n#   theme_minimal() +\n#   coord_sf(xlim = c(-119, -117), ylim = c(33, 35))\n\n#Look at data utilizing a poisson distribution model. \n# Fit a Poisson regression model\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npoisson_model <- glm(total_crimes ~ avg_income, \n                     family = poisson(link = \"log\"), \n                     data = crime_summary_lapd)\n\n# Summary of the model\nsummary(poisson_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = total_crimes ~ avg_income, family = poisson(link = \"log\"), \n    data = crime_summary_lapd)\n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.940e+00  1.979e-02   98.01   <2e-16 ***\navg_income  -4.382e-06  2.528e-07  -17.33   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 8430.6  on 2296  degrees of freedom\nResidual deviance: 8102.3  on 2295  degrees of freedom\nAIC: 15413\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n\n```{.r .cell-code}\nexp(coef(poisson_model))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)  avg_income \n  6.9570080   0.9999956 \n```\n\n\n:::\n\n```{.r .cell-code}\nresidual_deviance <- poisson_model$deviance\ndegrees_of_freedom <- poisson_model$df.residual\ndispersion <- residual_deviance / degrees_of_freedom\ndispersion\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.530416\n```\n\n\n:::\n\n```{.r .cell-code}\nquasi_poisson_model <- glm(total_crimes ~ avg_income, \n                           family = quasipoisson(link = \"log\"), \n                           data = crime_summary_lapd)\nsummary(quasi_poisson_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = total_crimes ~ avg_income, family = quasipoisson(link = \"log\"), \n    data = crime_summary_lapd)\n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.940e+00  5.037e-02   38.51  < 2e-16 ***\navg_income  -4.382e-06  6.434e-07   -6.81 1.24e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for quasipoisson family taken to be 6.476489)\n\n    Null deviance: 8430.6  on 2296  degrees of freedom\nResidual deviance: 8102.3  on 2295  degrees of freedom\nAIC: NA\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(MASS)\nnb_model <- glm.nb(total_crimes ~ avg_income, data = crime_summary_lapd)\nsummary(nb_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = total_crimes ~ avg_income, data = crime_summary_lapd, \n    init.theta = 2.288655763, link = log)\n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.924e+00  3.495e-02  55.062   <2e-16 ***\navg_income  -4.169e-06  4.179e-07  -9.977   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(2.2887) family taken to be 1)\n\n    Null deviance: 2336.5  on 2296  degrees of freedom\nResidual deviance: 2233.8  on 2295  degrees of freedom\nAIC: 11983\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  2.2887 \n          Std. Err.:  0.0926 \n\n 2 x log-likelihood:  -11977.1990 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_summary_lapd <- crime_summary_lapd %>%\n  mutate(fitted_crimes = predict(poisson_model, type = \"response\"))\n\n# Plot observed vs. predicted\nggplot(crime_summary_lapd, aes(x = avg_income, y = total_crimes)) +\n  geom_point() +\n  geom_line(aes(y = fitted_crimes), color = \"red\") +\n  labs(\n    title = \"Poisson Regression: Crime vs. Median Income\",\n    x = \"Median Income\",\n    y = \"Total Crimes\"\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Poisson-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncrime_summary_lapd <- crime_summary_lapd %>%\n  mutate(fitted_crimes_nb = predict(nb_model, type = \"response\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_summary_lapd <- crime_summary_lapd %>%\n  mutate(fitted_crimes_nb = predict(nb_model, type = \"response\"))\n\nggplot(crime_summary_lapd, aes(x = avg_income, y = total_crimes)) +\n  geom_point(alpha = 0.7) +\n  geom_line(aes(y = fitted_crimes_nb), color = \"blue\") +\n  labs(\n    title = \"Negative Binomial Regression: Crime vs. Median Income\",\n    x = \"Median Income\",\n    y = \"Total Crimes\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Neg Bin-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_summary_race <- crime_with_income %>%\n  group_by(GEOID, Descent_Description) %>%\n  summarize(\n    total_crimes = n(),  # Count crimes for each GEOID and Descent_Description group\n    avg_median_income = mean(estimate, na.rm = TRUE)\n  ) %>%\n  pivot_wider(\n    names_from = Descent_Description,\n    values_from = total_crimes,\n    values_fill = 0  # Fill missing values with 0 for crimes\n  ) %>%\n  rowwise() %>%\n  mutate(\n    total_crimes = sum(c_across(-c(GEOID, avg_median_income, geometry)), na.rm = TRUE)  # Sum only the crime columns\n  ) %>%\n  ungroup()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'GEOID'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_summary_race <- crime_summary_race %>%\n  rename_with(~ make.names(.), everything())\n\nbivar_poisson_model <- glm(\n  total_crimes ~ avg_median_income + Hispanic.Latin.Mexican + White + Black + Other + \n    Other.Asian + Unknown + Japanese + Korean + Filipino + Chinese + Hawaiian + \n    Asian.Indian + American.Indian.Alaskan.Native + Cambodian + Vietnamese + Laotian,\n  family = poisson(link = \"log\"),\n  data = crime_summary_race\n)\nsummary(bivar_poisson_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = total_crimes ~ avg_median_income + Hispanic.Latin.Mexican + \n    White + Black + Other + Other.Asian + Unknown + Japanese + \n    Korean + Filipino + Chinese + Hawaiian + Asian.Indian + American.Indian.Alaskan.Native + \n    Cambodian + Vietnamese + Laotian, family = poisson(link = \"log\"), \n    data = crime_summary_race)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                     5.342e-01  2.044e-02  26.133   <2e-16 ***\navg_median_income              -2.736e-06  2.547e-07 -10.742   <2e-16 ***\nHispanic.Latin.Mexican          1.655e-01  2.937e-03  56.356   <2e-16 ***\nWhite                           2.038e-01  5.124e-03  39.780   <2e-16 ***\nBlack                           1.700e-01  4.936e-03  34.437   <2e-16 ***\nOther                           1.790e-01  1.227e-02  14.593   <2e-16 ***\nOther.Asian                     2.020e-02  4.523e-02   0.447   0.6552    \nUnknown                         1.032e-01  1.612e-03  64.060   <2e-16 ***\nJapanese                       -3.522e-02  1.605e-01  -0.219   0.8263    \nKorean                          8.766e-02  7.250e-02   1.209   0.2266    \nFilipino                       -1.699e-01  1.118e-01  -1.519   0.1287    \nChinese                         1.525e-01  8.545e-02   1.784   0.0744 .  \nHawaiian                       -2.246e-01  3.782e-01  -0.594   0.5525    \nAsian.Indian                   -1.029e-01  3.336e-01  -0.309   0.7577    \nAmerican.Indian.Alaskan.Native -1.647e-01  1.950e-01  -0.845   0.3984    \nCambodian                      -2.265e-02  3.162e-01  -0.072   0.9429    \nVietnamese                     -2.529e-01  1.965e-01  -1.287   0.1980    \nLaotian                        -3.387e-01  1.000e+00  -0.339   0.7348    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 6173.9  on 5564  degrees of freedom\nResidual deviance: 2074.0  on 5547  degrees of freedom\n  (319 observations deleted due to missingness)\nAIC: 15858\n\nNumber of Fisher Scoring iterations: 6\n```\n\n\n:::\n\n```{.r .cell-code}\nbivar_nb_model <- glm.nb(total_crimes ~ avg_median_income + Hispanic.Latin.Mexican + White + Black + Other + \n    Other.Asian + Unknown + Japanese + Korean + Filipino + Chinese + Hawaiian + \n    Asian.Indian + American.Indian.Alaskan.Native + Cambodian + Vietnamese + Laotian, data = crime_summary_race)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in glm.nb(total_crimes ~ avg_median_income + Hispanic.Latin.Mexican + :\nalternation limit reached\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(bivar_nb_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = total_crimes ~ avg_median_income + Hispanic.Latin.Mexican + \n    White + Black + Other + Other.Asian + Unknown + Japanese + \n    Korean + Filipino + Chinese + Hawaiian + Asian.Indian + American.Indian.Alaskan.Native + \n    Cambodian + Vietnamese + Laotian, data = crime_summary_race, \n    init.theta = 24.74819092, link = log)\n\nCoefficients:\n                                 Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                     2.985e-01  2.278e-02  13.104  < 2e-16 ***\navg_median_income              -1.531e-06  2.654e-07  -5.769 7.95e-09 ***\nHispanic.Latin.Mexican          2.251e-01  4.221e-03  53.326  < 2e-16 ***\nWhite                           2.348e-01  6.021e-03  38.992  < 2e-16 ***\nBlack                           2.165e-01  6.348e-03  34.107  < 2e-16 ***\nOther                           2.142e-01  1.342e-02  15.957  < 2e-16 ***\nOther.Asian                     1.222e-01  4.625e-02   2.641  0.00826 ** \nUnknown                         1.757e-01  2.853e-03  61.570  < 2e-16 ***\nJapanese                        5.779e-02  1.665e-01   0.347  0.72856    \nKorean                          1.780e-01  7.480e-02   2.380  0.01733 *  \nFilipino                       -3.709e-02  1.146e-01  -0.324  0.74630    \nChinese                         1.953e-01  8.929e-02   2.187  0.02874 *  \nHawaiian                       -8.249e-02  3.873e-01  -0.213  0.83136    \nAsian.Indian                    9.135e-03  3.431e-01   0.027  0.97876    \nAmerican.Indian.Alaskan.Native -1.634e-02  1.994e-01  -0.082  0.93470    \nCambodian                       9.126e-02  3.242e-01   0.282  0.77831    \nVietnamese                     -1.173e-01  2.009e-01  -0.584  0.55944    \nLaotian                        -1.891e-01  1.020e+00  -0.185  0.85294    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(24.7489) family taken to be 1)\n\n    Null deviance: 5477.7  on 5564  degrees of freedom\nResidual deviance: 1349.0  on 5547  degrees of freedom\n  (319 observations deleted due to missingness)\nAIC: 15580\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  24.75 \n          Std. Err.:  1.49 \nWarning while fitting theta: alternation limit reached \n\n 2 x log-likelihood:  -15541.83 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_summary_race_model <- crime_summary_race %>%\n  filter(complete.cases(\n    avg_median_income, Hispanic.Latin.Mexican, White, Black, Other, Other.Asian,\n    Unknown, Japanese, Korean, Filipino, Chinese, Hawaiian, Asian.Indian,\n    American.Indian.Alaskan.Native, Cambodian, Vietnamese, Laotian\n  ))\n\n# Add predicted values to the filtered data\ncrime_summary_race_model <- crime_summary_race_model %>%\n  mutate(predicted_crimes = predict(bivar_nb_model, type = \"response\"))\n\ncrime_race_long <- crime_summary_race_model %>%\n  pivot_longer(\n    cols = c(Hispanic.Latin.Mexican, White, Black, Other, Other.Asian, Unknown, \n             Japanese, Korean, Filipino, Chinese, Hawaiian, Asian.Indian, \n             American.Indian.Alaskan.Native, Cambodian, Vietnamese, Laotian),\n    names_to = \"race\",\n    values_to = \"crime_count\"\n  )\n\n\ncrime_race_long <- crime_summary_race %>%\n  pivot_longer(\n    cols = c(Hispanic.Latin.Mexican, White, Black, Other, Other.Asian, Unknown, \n             Japanese, Korean, Filipino, Chinese, Hawaiian, Asian.Indian, \n             American.Indian.Alaskan.Native, Cambodian, Vietnamese, Laotian),\n    names_to = \"race\",\n    values_to = \"crime_count\"\n  ) %>%\n  filter(!is.na(crime_count) & crime_count > 0) %>%\n  mutate(avg_median_income = avg_median_income / 1000)\n\n\n\n# Fit Poisson regression with pivoted data\npoisson_model <- glm(\n  crime_count ~ avg_median_income + race,\n  family = poisson(link = \"log\"),\n  data = crime_race_long\n)\nsummary(poisson_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = crime_count ~ avg_median_income + race, family = poisson(link = \"log\"), \n    data = crime_race_long)\n\nCoefficients:\n                             Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                 0.1632419  0.2298224   0.710 0.477521    \navg_median_income          -0.0019821  0.0002549  -7.777 7.42e-15 ***\nraceAsian.Indian            0.0155105  0.4422303   0.035 0.972021    \nraceBlack                   0.6206238  0.2308355   2.689 0.007175 ** \nraceCambodian               0.1967529  0.5026375   0.391 0.695471    \nraceChinese                 0.1221015  0.2668446   0.458 0.647257    \nraceFilipino               -0.0125247  0.2612828  -0.048 0.961768    \nraceHawaiian               -0.0256375  0.4683073  -0.055 0.956342    \nraceHispanic.Latin.Mexican  0.8102344  0.2300788   3.522 0.000429 ***\nraceJapanese                0.0635533  0.3100358   0.205 0.837582    \nraceKorean                  0.1226668  0.2558546   0.479 0.631626    \nraceLaotian                -0.0216528  1.0259884  -0.021 0.983162    \nraceOther                   0.3349309  0.2320411   1.443 0.148905    \nraceOther.Asian             0.1312525  0.2378787   0.552 0.581111    \nraceUnknown                 0.7716858  0.2301287   3.353 0.000799 ***\nraceVietnamese             -0.0043229  0.3071443  -0.014 0.988771    \nraceWhite                   0.6653885  0.2304941   2.887 0.003892 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 6300.2  on 5907  degrees of freedom\nResidual deviance: 5790.0  on 5891  degrees of freedom\n  (339 observations deleted due to missingness)\nAIC: 20106\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n\n```{.r .cell-code}\n# Fit Negative Binomial regression with pivoted data\ncrime_race_long <- crime_race_long %>%\n  filter(complete.cases(avg_median_income, race, crime_count))\n\nnb_model <- glm.nb(\n  crime_count ~ avg_median_income * race,\n  data = crime_race_long\n)\n\ncrime_race_long <- crime_race_long %>%\n  mutate(predicted_crimes = predict(nb_model, newdata = crime_race_long, type = \"response\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(crime_race_long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"GEOID\"             \"avg_median_income\" \"geometry\"         \n[4] \"total_crimes\"      \"race\"              \"crime_count\"      \n[7] \"predicted_crimes\" \n```\n\n\n:::\n\n```{.r .cell-code}\ngrid <- expand.grid(\n  avg_median_income = seq(min(crime_race_long$avg_median_income), max(crime_race_long$avg_median_income), length.out = 100),\n  race = unique(crime_race_long$race)\n)\n\ngrid$predicted_crimes <- predict(nb_model, newdata = grid, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in predict.lm(object, newdata, se.fit, scale = 1, type = if (type == :\nprediction from rank-deficient fit; attr(*, \"non-estim\") has doubtful cases\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot(grid, aes(x = avg_median_income, y = predicted_crimes, color = race)) +\n  geom_line() +\n  labs(\n    title = \"Predicted Crime Counts vs Median Income by Race\",\n    x = \"Average Median Income (in $1,000s)\",\n    y = \"Predicted Crime Counts\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Refinement of model-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(grid, aes(x = avg_median_income, y = predicted_crimes, color = race)) +\n  geom_line() +\n  facet_wrap(~race, scales = \"free_y\") +  # Facet by race, allowing y-axis to vary by panel\n  labs(\n    title = \"Predicted Crime Counts vs Median Income by Race (Facet by Race)\",\n    x = \"Average Median Income (in $1,000s)\",\n    y = \"Predicted Crime Counts\"\n  ) +\n  theme_minimal() +\n  theme(\n    strip.text = element_text(size = 10),  # Adjust facet labels\n    legend.position = \"none\"              # Hide legend if redundant\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Refinement of model-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "blog-post-7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}