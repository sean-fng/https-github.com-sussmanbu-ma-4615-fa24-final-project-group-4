{
  "hash": "c34bbb5f68f3fcc69660d05ff83e6b55",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"blog post 7\"\nauthor: \"Sean Fung\"\ndate: \"2024-11-26\"\ndate-modified: \"2024-11-26\"\ndraft: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tidycensus)\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nhere() starts at /Users/seanfung/Documents/BU Fall 2024/MA 415/MA 415 G4 Final Project\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: viridisLite\n```\n\n\n:::\n\n```{.r .cell-code}\n# Load crime data and convert to spatial format\ndata <- readRDS(here(\"filtered_data_2.rds\"))\ncrime_sf <- st_as_sf(data, coords = c(\"LON\", \"LAT\"), crs = 4326)\n\n# Load neighborhood boundaries\nneighborhoods <- st_read(here(\"LA_Times_Neighborhood_Boundaries-shp/8494cd42-db48-4af1-a215-a2c8f61e96a22020328-1-621do0.x5yiu.shp\")) %>%\n  st_transform(st_crs(crime_sf))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `8494cd42-db48-4af1-a215-a2c8f61e96a22020328-1-621do0.x5yiu' from data source `/Users/seanfung/Documents/BU Fall 2024/MA 415/MA 415 G4 Final Project/LA_Times_Neighborhood_Boundaries-shp/8494cd42-db48-4af1-a215-a2c8f61e96a22020328-1-621do0.x5yiu.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 114 features and 2 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 6359592 ymin: 1715035 xmax: 6514633 ymax: 1945515\nProjected CRS: NAD83 / California zone 5 (ftUS)\n```\n\n\n:::\n\n```{.r .cell-code}\n# Join crime incidents with neighborhoods\ncrime_with_neighborhoods <- st_join(crime_sf, neighborhoods, join = st_within)\ncensus_api_key(\"c2aebe6041f0c99e41a3458ed8d0b95ee3650fa4\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTo install your API key for use in future sessions, run this function with `install = TRUE`.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Load and transform median income data\neconomic_data <- get_acs(\n  geography = \"block group\",\n  variables = c(median_income = \"B19013_001\"),\n  state = \"CA\",\n  county = \"Los Angeles\",\n  year = 2020,\n  geometry = TRUE\n) %>% \n  st_transform(st_crs(crime_with_neighborhoods))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nGetting data from the 2016-2020 5-year ACS\nDownloading feature geometry from the Census website.  To cache shapefiles for use in future sessions, set `options(tigris_use_cache = TRUE)`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n  |                                                                            \n  |                                                                      |   0%\n  |                                                                            \n  |                                                                      |   1%\n  |                                                                            \n  |=                                                                     |   1%\n  |                                                                            \n  |=                                                                     |   2%\n  |                                                                            \n  |==                                                                    |   2%\n  |                                                                            \n  |==                                                                    |   3%\n  |                                                                            \n  |===                                                                   |   4%\n  |                                                                            \n  |===                                                                   |   5%\n  |                                                                            \n  |====                                                                  |   5%\n  |                                                                            \n  |====                                                                  |   6%\n  |                                                                            \n  |=====                                                                 |   7%\n  |                                                                            \n  |=====                                                                 |   8%\n  |                                                                            \n  |======                                                                |   8%\n  |                                                                            \n  |======                                                                |   9%\n  |                                                                            \n  |=======                                                               |   9%\n  |                                                                            \n  |=======                                                               |  10%\n  |                                                                            \n  |=======                                                               |  11%\n  |                                                                            \n  |========                                                              |  11%\n  |                                                                            \n  |========                                                              |  12%\n  |                                                                            \n  |=========                                                             |  12%\n  |                                                                            \n  |=========                                                             |  13%\n  |                                                                            \n  |==========                                                            |  14%\n  |                                                                            \n  |==========                                                            |  15%\n  |                                                                            \n  |===========                                                           |  15%\n  |                                                                            \n  |===========                                                           |  16%\n  |                                                                            \n  |============                                                          |  17%\n  |                                                                            \n  |============                                                          |  18%\n  |                                                                            \n  |=============                                                         |  18%\n  |                                                                            \n  |=============                                                         |  19%\n  |                                                                            \n  |==============                                                        |  19%\n  |                                                                            \n  |==============                                                        |  20%\n  |                                                                            \n  |==============                                                        |  21%\n  |                                                                            \n  |===============                                                       |  21%\n  |                                                                            \n  |===============                                                       |  22%\n  |                                                                            \n  |================                                                      |  22%\n  |                                                                            \n  |================                                                      |  23%\n  |                                                                            \n  |=================                                                     |  24%\n  |                                                                            \n  |=================                                                     |  25%\n  |                                                                            \n  |==================                                                    |  25%\n  |                                                                            \n  |==================                                                    |  26%\n  |                                                                            \n  |===================                                                   |  27%\n  |                                                                            \n  |===================                                                   |  28%\n  |                                                                            \n  |====================                                                  |  28%\n  |                                                                            \n  |====================                                                  |  29%\n  |                                                                            \n  |=====================                                                 |  29%\n  |                                                                            \n  |=====================                                                 |  30%\n  |                                                                            \n  |=====================                                                 |  31%\n  |                                                                            \n  |======================                                                |  31%\n  |                                                                            \n  |======================                                                |  32%\n  |                                                                            \n  |=======================                                               |  32%\n  |                                                                            \n  |=======================                                               |  33%\n  |                                                                            \n  |========================                                              |  34%\n  |                                                                            \n  |========================                                              |  35%\n  |                                                                            \n  |=========================                                             |  35%\n  |                                                                            \n  |=========================                                             |  36%\n  |                                                                            \n  |==========================                                            |  37%\n  |                                                                            \n  |==========================                                            |  38%\n  |                                                                            \n  |===========================                                           |  38%\n  |                                                                            \n  |===========================                                           |  39%\n  |                                                                            \n  |============================                                          |  39%\n  |                                                                            \n  |============================                                          |  40%\n  |                                                                            \n  |============================                                          |  41%\n  |                                                                            \n  |=============================                                         |  41%\n  |                                                                            \n  |=============================                                         |  42%\n  |                                                                            \n  |==============================                                        |  42%\n  |                                                                            \n  |==============================                                        |  43%\n  |                                                                            \n  |===============================                                       |  44%\n  |                                                                            \n  |===============================                                       |  45%\n  |                                                                            \n  |================================                                      |  45%\n  |                                                                            \n  |================================                                      |  46%\n  |                                                                            \n  |=================================                                     |  47%\n  |                                                                            \n  |=================================                                     |  48%\n  |                                                                            \n  |==================================                                    |  48%\n  |                                                                            \n  |==================================                                    |  49%\n  |                                                                            \n  |===================================                                   |  49%\n  |                                                                            \n  |===================================                                   |  50%\n  |                                                                            \n  |===================================                                   |  51%\n  |                                                                            \n  |====================================                                  |  51%\n  |                                                                            \n  |====================================                                  |  52%\n  |                                                                            \n  |=====================================                                 |  52%\n  |                                                                            \n  |=====================================                                 |  53%\n  |                                                                            \n  |======================================                                |  54%\n  |                                                                            \n  |======================================                                |  55%\n  |                                                                            \n  |=======================================                               |  55%\n  |                                                                            \n  |=======================================                               |  56%\n  |                                                                            \n  |========================================                              |  57%\n  |                                                                            \n  |========================================                              |  58%\n  |                                                                            \n  |=========================================                             |  58%\n  |                                                                            \n  |=========================================                             |  59%\n  |                                                                            \n  |==========================================                            |  59%\n  |                                                                            \n  |==========================================                            |  60%\n  |                                                                            \n  |==========================================                            |  61%\n  |                                                                            \n  |===========================================                           |  61%\n  |                                                                            \n  |===========================================                           |  62%\n  |                                                                            \n  |============================================                          |  62%\n  |                                                                            \n  |============================================                          |  63%\n  |                                                                            \n  |=============================================                         |  64%\n  |                                                                            \n  |=============================================                         |  65%\n  |                                                                            \n  |==============================================                        |  65%\n  |                                                                            \n  |==============================================                        |  66%\n  |                                                                            \n  |===============================================                       |  67%\n  |                                                                            \n  |===============================================                       |  68%\n  |                                                                            \n  |================================================                      |  68%\n  |                                                                            \n  |================================================                      |  69%\n  |                                                                            \n  |=================================================                     |  69%\n  |                                                                            \n  |=================================================                     |  70%\n  |                                                                            \n  |=================================================                     |  71%\n  |                                                                            \n  |==================================================                    |  71%\n  |                                                                            \n  |==================================================                    |  72%\n  |                                                                            \n  |===================================================                   |  72%\n  |                                                                            \n  |===================================================                   |  73%\n  |                                                                            \n  |====================================================                  |  74%\n  |                                                                            \n  |====================================================                  |  75%\n  |                                                                            \n  |=====================================================                 |  75%\n  |                                                                            \n  |=====================================================                 |  76%\n  |                                                                            \n  |======================================================                |  77%\n  |                                                                            \n  |======================================================                |  78%\n  |                                                                            \n  |=======================================================               |  78%\n  |                                                                            \n  |=======================================================               |  79%\n  |                                                                            \n  |========================================================              |  79%\n  |                                                                            \n  |========================================================              |  80%\n  |                                                                            \n  |========================================================              |  81%\n  |                                                                            \n  |=========================================================             |  81%\n  |                                                                            \n  |=========================================================             |  82%\n  |                                                                            \n  |==========================================================            |  82%\n  |                                                                            \n  |==========================================================            |  83%\n  |                                                                            \n  |===========================================================           |  84%\n  |                                                                            \n  |===========================================================           |  85%\n  |                                                                            \n  |============================================================          |  85%\n  |                                                                            \n  |============================================================          |  86%\n  |                                                                            \n  |=============================================================         |  87%\n  |                                                                            \n  |=============================================================         |  88%\n  |                                                                            \n  |==============================================================        |  88%\n  |                                                                            \n  |==============================================================        |  89%\n  |                                                                            \n  |===============================================================       |  89%\n  |                                                                            \n  |===============================================================       |  90%\n  |                                                                            \n  |================================================================      |  91%\n  |                                                                            \n  |================================================================      |  92%\n  |                                                                            \n  |=================================================================     |  92%\n  |                                                                            \n  |=================================================================     |  93%\n  |                                                                            \n  |==================================================================    |  94%\n  |                                                                            \n  |==================================================================    |  95%\n  |                                                                            \n  |===================================================================   |  95%\n  |                                                                            \n  |===================================================================   |  96%\n  |                                                                            \n  |====================================================================  |  97%\n  |                                                                            \n  |====================================================================  |  98%\n  |                                                                            \n  |===================================================================== |  98%\n  |                                                                            \n  |===================================================================== |  99%\n  |                                                                            \n  |======================================================================|  99%\n  |                                                                            \n  |======================================================================| 100%\n```\n\n\n:::\n\n```{.r .cell-code}\n# Join income with neighborhood-level crime data\ncrime_with_income <- st_join(crime_with_neighborhoods, economic_data, join = st_within)\n\n# Summarize crime data by neighborhood\ncrime_summary <- crime_with_income %>%\n  group_by(GEOID) %>%\n  summarize(\n    total_crimes = n(),\n    avg_income = mean(estimate, na.rm = TRUE),\n    geometry = st_union(geometry)\n  ) %>%\n  filter(!is.na(avg_income)) %>%  # Remove rows with missing income\n  st_as_sf()\n\n\n\nlapd_boundary <- st_read(here(\"CityBoundaryofLosAngeles/geo_export_416eaeda-447a-4473-b003-37e2cad181ac.shp\")) %>%\n  st_transform(st_crs(crime_sf))  # Align CRS\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `geo_export_416eaeda-447a-4473-b003-37e2cad181ac' from data source `/Users/seanfung/Documents/BU Fall 2024/MA 415/MA 415 G4 Final Project/CityBoundaryofLosAngeles/geo_export_416eaeda-447a-4473-b003-37e2cad181ac.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1 feature and 2 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -118.6682 ymin: 33.70365 xmax: -118.1554 ymax: 34.33731\nGeodetic CRS:  WGS84(DD)\n```\n\n\n:::\n\n```{.r .cell-code}\ncrime_within_lapd <- crime_sf %>%\n  filter(rowSums(st_within(geometry, st_geometry(lapd_boundary), sparse = FALSE)) > 0)\n\ncrime_with_income_lapd <- st_join(crime_within_lapd, economic_data, join = st_within)\n\neconomic_data_lapd <- st_intersection(economic_data, lapd_boundary)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n```\n\n\n:::\n\n```{.r .cell-code}\n# Update the crime summary\ncrime_summary_lapd <- crime_with_income_lapd %>%\n  group_by(GEOID) %>%\n  summarize(\n    total_crimes = n(),\n    avg_income = mean(estimate, na.rm = TRUE),\n    geometry = st_union(geometry)\n  ) %>%\n  filter(!is.na(avg_income)) %>%  # Exclude rows with missing income\n  st_as_sf()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Update visualizations\nggplot(crime_summary_lapd, aes(x = avg_income, y = total_crimes)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"Crime vs Median Income (LAPD Jurisdiction)\", x = \"Median Income\", y = \"Total Crimes\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Crime Vs Median Income-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_sf(data = economic_data_lapd, aes(fill = estimate), color = NA) +  # Median income layer\n  scale_fill_viridis_c(option = \"magma\", na.value = \"grey50\") +\n  scale_color_viridis_c(option = \"inferno\", na.value = \"grey50\") +\n  labs(\n    title = \"Median Income within LAPD Jurisdiction\",\n    fill = \"Median Income\",\n    color = \"Average Income\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 18, hjust = 0.5),\n    legend.title = element_text(size = 14),\n    legend.text = element_text(size = 12),\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 10)\n  ) +\n  coord_sf(\n    xlim = c(-119, -117),  # Focus on the Los Angeles area\n    ylim = c(33, 35)       # Focus on the Los Angeles area\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Heatmap within LAPD Jurisdiction-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_within_lapd <- st_transform(crime_within_lapd, st_crs(economic_data_lapd))\n\nggplot() +\n  # Median income heatmap\n  geom_sf(data = economic_data_lapd, aes(fill = estimate), color = NA) +  \n  scale_fill_viridis_c(option = \"magma\", na.value = \"grey50\") +\n  scale_color_viridis_c(option = \"inferno\", na.value = \"grey50\") +\n  # Overlay crime points\n  geom_sf(data = crime_within_lapd, aes(), color = \"black\", shape = 4, size = 0.5, alpha = 0.7) +\n  labs(\n    title = \"Median Income and Crime Data within LAPD Jurisdiction\",\n    fill = \"Median Income\",\n    color = \"Average Income\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 18, hjust = 0.5),\n    legend.title = element_text(size = 14),\n    legend.text = element_text(size = 12),\n    axis.title = element_text(size = 12),\n    axis.text = element_text(size = 10)\n  ) +\n  coord_sf(\n    xlim = c(-119, -117),  # Focus on the Los Angeles area\n    ylim = c(33, 35)       # Focus on the Los Angeles area\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Heatmap with Crime Data-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#Good place to use shinylive here. Can filter by year. \n\n# crime_filtered <- crime_within_lapd %>%\n#   filter(year == 2021)\n# ggplot() +\n#   geom_sf(data = economic_data_lapd, aes(fill = estimate), color = NA) +  \n#   scale_fill_viridis_c(option = \"magma\", na.value = \"grey50\") +\n#   geom_sf(data = crime_filtered, aes(), color = \"black\", shape = 4, size = 0.5, alpha = 0.7) +\n#   labs(\n#     title = \"Median Income and 2020 Crime Data within LAPD Jurisdiction\",\n#     fill = \"Median Income\"\n#   ) +\n#   theme_minimal() +\n#   coord_sf(xlim = c(-119, -117), ylim = c(33, 35))\n\n#Look at data utilizing a poisson distribution model. \n# Fit a Poisson regression model\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npoisson_model <- glm(total_crimes ~ avg_income, \n                     family = poisson(link = \"log\"), \n                     data = crime_summary_lapd)\n\n# Summary of the model\nsummary(poisson_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = total_crimes ~ avg_income, family = poisson(link = \"log\"), \n    data = crime_summary_lapd)\n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.940e+00  1.979e-02   98.01   <2e-16 ***\navg_income  -4.382e-06  2.528e-07  -17.33   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 8430.6  on 2296  degrees of freedom\nResidual deviance: 8102.3  on 2295  degrees of freedom\nAIC: 15413\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n\n```{.r .cell-code}\nexp(coef(poisson_model))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)  avg_income \n  6.9570080   0.9999956 \n```\n\n\n:::\n\n```{.r .cell-code}\nresidual_deviance <- poisson_model$deviance\ndegrees_of_freedom <- poisson_model$df.residual\ndispersion <- residual_deviance / degrees_of_freedom\ndispersion\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.530416\n```\n\n\n:::\n\n```{.r .cell-code}\nquasi_poisson_model <- glm(total_crimes ~ avg_income, \n                           family = quasipoisson(link = \"log\"), \n                           data = crime_summary_lapd)\nsummary(quasi_poisson_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = total_crimes ~ avg_income, family = quasipoisson(link = \"log\"), \n    data = crime_summary_lapd)\n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.940e+00  5.037e-02   38.51  < 2e-16 ***\navg_income  -4.382e-06  6.434e-07   -6.81 1.24e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for quasipoisson family taken to be 6.476489)\n\n    Null deviance: 8430.6  on 2296  degrees of freedom\nResidual deviance: 8102.3  on 2295  degrees of freedom\nAIC: NA\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(MASS)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'MASS'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n\n\n:::\n\n```{.r .cell-code}\nnb_model <- glm.nb(total_crimes ~ avg_income, data = crime_summary_lapd)\nsummary(nb_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = total_crimes ~ avg_income, data = crime_summary_lapd, \n    init.theta = 2.288655763, link = log)\n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  1.924e+00  3.495e-02  55.062   <2e-16 ***\navg_income  -4.169e-06  4.179e-07  -9.977   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(2.2887) family taken to be 1)\n\n    Null deviance: 2336.5  on 2296  degrees of freedom\nResidual deviance: 2233.8  on 2295  degrees of freedom\nAIC: 11983\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  2.2887 \n          Std. Err.:  0.0926 \n\n 2 x log-likelihood:  -11977.1990 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_summary_lapd <- crime_summary_lapd %>%\n  mutate(fitted_crimes = predict(poisson_model, type = \"response\"))\n\n# Plot observed vs. predicted\nggplot(crime_summary_lapd, aes(x = avg_income, y = total_crimes)) +\n  geom_point() +\n  geom_line(aes(y = fitted_crimes), color = \"red\") +\n  labs(\n    title = \"Poisson Regression: Crime vs. Median Income\",\n    x = \"Median Income\",\n    y = \"Total Crimes\"\n  )\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Poisson-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncrime_summary_lapd <- crime_summary_lapd %>%\n  mutate(fitted_crimes_nb = predict(nb_model, type = \"response\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncrime_summary_lapd <- crime_summary_lapd %>%\n  mutate(fitted_crimes_nb = predict(nb_model, type = \"response\"))\n\nggplot(crime_summary_lapd, aes(x = avg_income, y = total_crimes)) +\n  geom_point(alpha = 0.7) +\n  geom_line(aes(y = fitted_crimes_nb), color = \"blue\") +\n  labs(\n    title = \"Negative Binomial Regression: Crime vs. Median Income\",\n    x = \"Median Income\",\n    y = \"Total Crimes\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](blog-post-7_files/figure-html/Neg Bin-1.png){width=672}\n:::\n:::\n\n\n\n\n\n```\n\n\n",
    "supporting": [
      "blog-post-7_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}